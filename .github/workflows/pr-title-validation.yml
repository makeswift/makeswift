name: PR Title Validation
on:
  pull_request:
    types: [opened, edited, reopened, synchronize]
jobs:
  validate:
    name: Validate PR Title
    runs-on: ubuntu-latest
    steps:
      - name: Validate Conventional Commits Format
        uses: actions/github-script@v7
        with:
          script: |
            const title = context.payload.pull_request.title;

            // Format: <type>[(scope)][!]: <description> or BREAKING CHANGE: <description>
            // Examples: feat(api): add new feature, fix!: resolve bug, hotfix(ui)!: urgent fix, BREAKING CHANGE: drop node 12
            const conventionalCommitRegex = /^((feat|fix|docs|style|refactor|test|chore|perf|ci|build|revert|example|debug|hotfix)(\s?\([^)]+\))?!?|BREAKING CHANGE): .+$/;

            if (!conventionalCommitRegex.test(title)) {
              core.setFailed(
                `PR title "${title}" does not follow the conventional commits format.\n\n` +
                `Expected format: <type>[(scope)][!]: <description> or BREAKING CHANGE: <description>\n` +
                `Examples:\n` +
                `  feat(ui): add new button\n` +
                `  fix!: resolve critical bug\n` +
                `  hotfix(api)!: urgent fix\n` +
                `  BREAKING CHANGE: change API response format\n\n` +
                `Valid types: feat, fix, docs, style, refactor, test, chore, perf, ci, build, revert, example, debug, hotfix`
              );
            } else {
              core.info(`PR title "${title}" follows the conventional commits format.`);
            }
